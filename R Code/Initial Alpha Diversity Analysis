library(phyloseq)
library(tidyverse)
library(ggplot2)
library(vegan) 

# create one plot with two boxplots (one for each feed type) vs shannon diversity in the low mom_bmi category
low_bmi_boxplot <- plot_richness(low_BMI_phyloseq_rare, x = "feed", measures = c("Shannon")) +
  xlab("Feeding Mode") +
  geom_boxplot()
low_bmi_boxplot

# run significance test
low_alphadiv <- estimate_richness(low_BMI_phyloseq_rare)
low_samp_dat <- sample_data(low_BMI_phyloseq_rare)
low_samp_dat_bmi <- data.frame(low_samp_dat, low_alphadiv)

low_wilcox_test_result <- wilcox.test(Shannon ~ feed, data = low_samp_dat_bmi)
low_wilcox_test_result

# create one plot with two boxplots (one for each feed type) vs shannon diversity in the high mom_bmi category
high_bmi_boxplot <- plot_richness(high_BMI_phyloseq_rare, x = "feed", measures = c("Shannon")) +
  xlab("Feeding Mode") +
  geom_boxplot()
high_bmi_boxplot

# run significance test
high_alphadiv <- estimate_richness(high_BMI_phyloseq_rare)
high_samp_dat <- sample_data(high_BMI_phyloseq_rare)
high_samp_dat_bmi <- data.frame(high_samp_dat, high_alphadiv)

high_wilcox_test_result <- wilcox.test(Shannon ~ feed, data = high_samp_dat_bmi)
high_wilcox_test_result

# create one plot with two boxplots (one for each feed type) vs shannon diversity in the all bmi category
all_bmi_boxplot_feed <- plot_richness(all_BMI_phyloseq_rare, x = "feed", measures = c("Shannon")) +
  xlab("Feeding Mode") +
  geom_boxplot()
all_bmi_boxplot_feed

# run significance test
alphadiv <- estimate_richness(all_BMI_phyloseq_rare)
samp_dat <- sample_data(all_BMI_phyloseq_rare)
samp_dat_bmi <- data.frame(samp_dat, alphadiv)

wilcox_test_result <- wilcox.test(Shannon ~ feed, data = samp_dat_bmi)
wilcox_test_result

# create one plot with two boxplots (high vs low bmi category) vs shannon diversity in the all bmi category
# used a separate phyloseq object that had a new column with low vs high mom bmi classification
all_bmi_boxplot_bmi <- plot_richness(all_BMI_phyloseq_rare_new, x = "mom_bmi_label", measures = c("Shannon")) +
  xlab("Mom BMI") +
  geom_boxplot()
all_bmi_boxplot_bmi

# run significance test
alphadiv_new <- estimate_richness(all_BMI_phyloseq_rare_new)
samp_dat_new <- sample_data(all_BMI_phyloseq_rare_new)
samp_dat_bmi_new <- data.frame(samp_dat_new, alphadiv_new)

wilcox_test_result <- wilcox.test(Shannon ~ mom_bmi_label, data = samp_dat_bmi_new)
wilcox_test_result
